<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Frogger Classic Engine - Zoro 2</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; background: #000; display: flex; justify-content: center; align-items: center; height: 100vh; }
        canvas { border: 2px solid #555; }
    </style>
</head>
<body>
<script>
let Level = 1;
let bandHeight, X, Y, offset = 0;
let alterOffset = 2; // سرعة الحركة
let diameter;
let Message = "";
let gameover = false;

function setup() {
    createCanvas(windowWidth, windowHeight);
    initFrog();
}

function initFrog() {
    bandHeight = height / (Level + 4);
    X = width / 2;
    Y = bandHeight * (Level + 3) + (bandHeight / 2);
}

function draw() {
    background(0);
    bandHeight = height / (Level + 4);
    diameter = bandHeight * 0.6; // تكبير الضفدع قليلاً للرؤية

    drawWorld();
    
    if (!gameover) {
        drawFrog(X, Y, diameter);
        if (drawHazards()) {
            gameover = true;
            Message = "انتهت اللعبة! حاول ثانية";
        } else {
            offset = (offset + alterOffset) % width;
            Message = "المستوى " + Level;
        }
    } else {
        fill(255, 0, 0);
        textAlign(CENTER);
        textSize(32);
        text(Message, width / 2, height / 2);
    }
    
    displayMessage(Message);
}

function drawWorld() {
    for (let i = 0; i < Level + 4; i++) {
        if (i == 0 || i == (Level + 3)) {
            fill(120, 150, 186); // لون منطقة الأمان
        } else {
            fill(20, 20, 20); // لون الطريق
        }
        noStroke();
        rect(0, i * bandHeight, width, bandHeight);
    }
}

function drawFrog(x, y, diam) {
    fill(0, 255, 0);
    ellipse(x, y, diam, diam); // جسم الضفدع
    fill(0, 150, 0);
    ellipse(x - diam/3, y - diam/3, diam/3, diam/3); // عين
    ellipse(x + diam/3, y - diam/3, diam/3, diam/3); // عين
}

function drawHazards() {
    let collision = false;
    for (let line = 0; line < Level + 2; line++) {
        let y = (line + 1) * bandHeight + (bandHeight / 2);
        let speed = (line % 2 == 0 ? 1 : -1) * (line + 1) * 2;
        let xPos = (offset * speed) % width;
        
        fill(200, 50, 50); // لون العوائق
        rect(xPos, y - 10, 50, 20);
        rect(xPos - width, y - 10, 50, 20); // تكرار لضمان السلاسة
        
        // كشف التصادم
        if (dist(X, Y, xPos, y) < diameter) collision = true;
    }
    return collision;
}

function keyPressed() {
    if (gameover) {
        gameover = false;
        Level = 1;
        initFrog();
        return;
    }
    if (keyCode === UP_ARROW || key === 'w') Y -= bandHeight;
    if (keyCode === DOWN_ARROW || key === 's') Y += bandHeight;
    if (keyCode === LEFT_ARROW || key === 'a') X -= bandHeight;
    if (keyCode === RIGHT_ARROW || key === 'd') X += bandHeight;
    
    if (Y <= bandHeight) {
        Level++;
        initFrog();
    }
}

function displayMessage(m) {
    fill(255);
    textSize(20);
    textAlign(LEFT);
    text(m, 20, 30);
}

// دعم اللمس للهواتف
function mousePressed() {
    if (mouseY < height/3) Y -= bandHeight;
    else if (mouseY > 2*height/3) Y += bandHeight;
    else if (mouseX < width/2) X -= bandHeight;
    else X += bandHeight;
    
    if (Y <= bandHeight) {
        Level++;
        initFrog();
    }
}
</script>
</body>
</html>
